<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>إدارة الوثائق</title>

  <style>
    body { margin: 0; font-family: sans-serif; direction: rtl; background: #f5f5f5; }

    .sidebar {
      width: 220px; background: #1e1e2f; color: white;
      height: 100vh; position: fixed; top: 0; right: 0; padding-top: 20px;
    }
    .sidebar-menu { list-style: none; padding: 0; }
    .sidebar-menu li { margin: 10px 0; }
    .sidebar-menu a {
      color: white; text-decoration: none; padding: 10px 20px; display: block;
    }
    .sidebar-menu a:hover { background: #33334d; }

    .topbar {
      height: 50px; background: #ffffff; display: flex; align-items: center;
      justify-content: space-between; padding: 0 15px; margin-right: 220px;
      border-bottom: 1px solid #ddd;
    }

    .content { margin-right: 220px; padding: 20px; }

    table {
      width: 100%; border-collapse: collapse; background: white;
    }
    th, td {
      padding: 12px; border-bottom: 1px solid #ddd; text-align: right;
    }
    th { background: #f0f0f0; }

    button {
      padding: 6px 12px; border: none; background: #1e1e2f;
      color: white; cursor: pointer; border-radius: 4px;
    }
    button:hover { background: #33334d; }

    .add-box {
      background: white; padding: 20px; margin-bottom: 20px;
      border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    input, select {
      padding: 8px; width: 200px; margin-left: 10px;
    }
  </style>
</head>

<body>

  <!-- Sidebar -->
  <div class="sidebar">
    <ul class="sidebar-menu">
      <li><a href="dashboard.html">الداشبورد</a></li>
      <li><a href="vehicles.html">المركبات</a></li>
      <li><a href="drivers.html">السائقين</a></li>
      <li><a href="maintenance.html">الصيانة</a></li>
      <li><a href="documents.html">الوثائق</a></li>
      <li><a href="users.html">المستخدمين</a></li>
      <li><a href="settings.html">الإعدادات</a></li>
      <li><a href="#" id="logoutBtn">تسجيل الخروج</a></li>
    </ul>
  </div>

  <!-- Topbar -->
  <div class="topbar">
    <div>إدارة الوثائق</div>
    <div id="username-display"></div>
  </div>

  <!-- Content -->
  <div class="content">

    <div class="add-box">
      <h3>إضافة وثيقة جديدة</h3>

      <select id="vehicle">
        <option value="">اختر المركبة</option>
      </select>

      <input id="title" type="text" placeholder="عنوان الوثيقة">
      <input id="url" type="text" placeholder="رابط الوثيقة (PDF أو صورة)">
      <input id="expiry" type="date">

      <button id="addDocumentBtn">إضافة</button>
    </div>

    <h3>قائمة الوثائق</h3>

    <table>
      <thead>
        <tr>
          <th>المركبة</th>
          <th>العنوان</th>
          <th>الرابط</th>
          <th>تاريخ الانتهاء</th>
          <th>إجراءات</th>
        </tr>
      </thead>
      <tbody id="documents-table"></tbody>
    </table>

  </div>

  <!-- Scripts -->
  <script type="module">
    import {
      auth,
      db,
      signOut,
      ref,
      set,
      onValue,
      remove
    } from "./firebase.js";

    // تسجيل الخروج
    document.getElementById("logoutBtn").onclick = () => {
      signOut(auth).then(() => location.href = "login.html");
    };

    // تحميل المركبات
    onValue(ref(db, "vehicles"), snap => {
      const select = document.getElementById("vehicle");
      select.innerHTML = `<option value="">اختر المركبة</option>`;

