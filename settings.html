<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>الإعدادات</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body>

<div id="sidebar"></div>
<div id="topbar"></div>

<main class="page-content">

  <h1>إعدادات النظام</h1>

  <div class="settings-card">

    <label>اسم النظام</label>
    <input id="systemName" type="text">

    <label>اسم الشركة</label>
    <input id="companyName" type="text">

    <label>رقم التواصل</label>
    <input id="companyPhone" type="text">

    <label>البريد الإلكتروني</label>
    <input id="companyEmail" type="email">

    <button class="btn primary" onclick="saveSettings()">حفظ الإعدادات</button>

  </div>

</main>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

<script src="firebase.js"></script>
<script src="session.js"></script>
<script src="permissions.js"></script>

<script>
  protectPage("manage_settings");

  fetch("sidebar.html").then(r => r.text()).then(html => sidebar.innerHTML = html);
  fetch("topbar.html").then(r => r.text()).then(html => topbar.innerHTML = html);

  readData("settings", data => {
    if (!data) return;
    systemName.value = data.systemName || "";
    companyName.value = data.companyName || "";
    companyPhone.value = data.companyPhone || "";
    companyEmail.value = data.companyEmail || "";
  });

  async function saveSettings() {
    const data = {
      systemName: systemName.value.trim(),
      companyName: companyName.value.trim(),
      companyPhone: companyPhone.value.trim(),
      companyEmail: companyEmail.value.trim()
    };

    await updateData("settings", data);
    alert("تم حفظ الإعدادات بنجاح");
  }
</script>

</body>
</html>
