<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title data-lang="reports_page">التقارير</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div id="sidebar"></div>
  <div id="topbar"></div>

  <main class="container">
    <header class="page-header">
      <h1 data-lang="reports_page">التقارير</h1>
    </header>

    <section class="reports-grid">
      <div class="report-card">
        <h3 data-lang="report_movements">حركات اليوم</h3>
        <p id="reportMovements">0</p>
      </div>
      <div class="report-card">
        <h3 data-lang="report_maintenance">تكاليف الصيانة</h3>
        <p id="reportMaintenance">0</p>
      </div>
    </section>
  </main>

  <script src="firebase.js"></script>
  <script src="session.js"></script>
  <script src="ui.js"></script>
  <script src="lang.js"></script>
  <script>
    ensureAuthRedirect();

    async function loadReports(){
      const movements = await readOnce('movements') || {};
      const maintenance = await readOnce('maintenance') || {};
      const today = new Date(); today.setHours(0,0,0,0);
      const mvCount = Object.values(movements).filter(m => (m.timestamp||0) >= today.getTime()).length;
      const maintCost = Object.values(maintenance).reduce((s,m)=> s + (parseFloat(m.cost)||0), 0);
      document.getElementById('reportMovements').textContent = mvCount;
      document.getElementById('reportMaintenance').textContent = maintCost;
    }

    applyTranslations();
    loadReports();
  </script>
</body>
</html>
