<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>إنشاء مدير مسؤول</title>
</head>
<body>

<h2>إنشاء مستخدم مدير مسؤول (Admin)</h2>

<label>البريد الإلكتروني:</label>
<input id="email" type="email" placeholder="admin@fleet.com"><br><br>

<label>كلمة المرور:</label>
<input id="password" type="password" placeholder="123456"><br><br>

<label>الاسم:</label>
<input id="name" type="text" placeholder="Super Admin"><br><br>

<button onclick="createAdmin()">إنشاء المستخدم</button>

<p id="result" style="margin-top:20px;color:green;font-weight:bold;"></p>

<!-- Firebase v9 -->
<script type="module">

  // استيراد مكتبات Firebase v9
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
  import { getAuth, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js";
  import { getDatabase, ref, set } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js";

  // إعدادات Firebase الخاصة بك
  const firebaseConfig = {
    apiKey: "AIzaSyDkJ85bI9-6Q_N97dqhBhpWgytqKoM6VH0",
    authDomain: "fleet-123.firebaseapp.com",
    databaseURL: "https://fleet-123-default-rtdb.firebaseio.com",
    projectId: "fleet-123",
    storageBucket: "fleet-123.firebasestorage.app",
    messagingSenderId: "266130114678",
    appId: "1:266130114678:web:56e89b5922749a00c4f757"
  };

  // تشغيل Firebase
  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getDatabase(app);

  // دالة إنشاء مدير مسؤول
  async function createAdmin() {
    const email = document.getElementById("email").value.trim();
    const password = document.getElementById("password").value.trim();
    const name = document.getElementById("name").value.trim();

    try {
      // إنشاء المستخدم في Authentication
      const userCredential = await createUserWithEmailAndPassword(auth, email, password);
      const uid = userCredential.user.uid;

      // تخزين بيانات المستخدم في Realtime Database
      await set(ref(db, "users/" + uid), {
        email: email,
        name: name,
        role: "admin",
        created_at: Date.now()
      });

      document.getElementById("result").innerText =
        "تم إنشاء المدير المسؤول بنجاح. يمكنك الآن حذف هذه الصفحة.";

    } catch (error) {
      document.getElementById("result").style.color = "red";
      document.getElementById("result").innerText = "خطأ: " + error.message;
    }
  }

  // جعل الدالة متاحة في الـ HTML
  window.createAdmin = createAdmin;

</script>

</body>
</html>
