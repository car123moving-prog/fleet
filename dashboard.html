<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>الداشبورد</title>

  <style>
    body { margin: 0; font-family: sans-serif; direction: rtl; background: #f5f5f5; }

    .sidebar {
      width: 220px; background: #1e1e2f; color: white;
      height: 100vh; position: fixed; top: 0; right: 0; padding-top: 20px;
    }
    .sidebar-menu { list-style: none; padding: 0; }
    .sidebar-menu li { margin: 10px 0; }
    .sidebar-menu a {
      color: white; text-decoration: none; padding: 10px 20px; display: block;
    }
    .sidebar-menu a:hover { background: #33334d; }

    .topbar {
      height: 50px; background: #ffffff; display: flex; align-items: center;
      justify-content: space-between; padding: 0 15px; margin-right: 220px;
      border-bottom: 1px solid #ddd;
    }

    .content { margin-right: 220px; padding: 20px; }

    .card {
      background: white; padding: 20px; border-radius: 8px;
      margin-bottom: 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
  </style>
</head>

<body>

  <!-- Sidebar -->
  <div class="sidebar">
    <ul class="sidebar-menu">
      <li><a href="dashboard.html">الداشبورد</a></li>
      <li><a href="vehicles.html">المركبات</a></li>
      <li><a href="drivers.html">السائقين</a></li>
      <li><a href="maintenance.html">الصيانة</a></li>
      <li><a href="documents.html">الوثائق</a></li>
      <li><a href="users.html">المستخدمين</a></li>
      <li><a href="settings.html">الإعدادات</a></li>
      <li><a href="#" id="logoutBtn">تسجيل الخروج</a></li>
    </ul>
  </div>

  <!-- Topbar -->
  <div class="topbar">
    <div>لوحة التحكم</div>
    <div id="username-display"></div>
  </div>

  <!-- Content -->
  <div class="content">
    <h1>مرحبًا بك في لوحة التحكم</h1>

    <div class="card">
      <h3>إحصائيات سريعة</h3>
      <p>عدد المركبات: <span id="vehicles-count">...</span></p>
      <p>عدد السائقين: <span id="drivers-count">...</span></p>
      <p>عدد المستخدمين: <span id="users-count">...</span></p>
    </div>
  </div>

  <!-- Scripts -->
  <script type="module">
    import { auth, db, signOut, ref, onValue } from "./firebase.js";

    // تسجيل الخروج
    document.getElementById("logoutBtn").onclick = () => {
      signOut(auth).then(() => location.href = "login.html");
    };

    // تحميل الإحصائيات
    onValue(ref(db, "vehicles"), snap => {
      document.getElementById("vehicles-count").innerText = snap.size || snap.numChildren();
    });

    onValue(ref(db, "drivers"), snap => {
      document.getElementById("drivers-count").innerText = snap.size || snap.numChildren();
    });

    onValue(ref(db, "users"), snap => {
      document.getElementById("users-count").innerText = snap.size || snap.numChildren();
    });
  </script>

  <script type="module" src="session.js"></script>
  <script type="module" src="permissions.js"></script>

</body>
</html>
